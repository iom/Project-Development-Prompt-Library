<div class="space-y-4">
    <div class="text-sm text-gray-600 mb-4">
        Found {{ total }} prompts
    </div>
    
    {% for prompt in items %}
    <div class="bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow">
        <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 mb-1">
                    <button onclick="togglePromptDetails('{{ prompt.id }}')" class="hover:text-blue-600 text-left">
                        {{ prompt.title }}
                    </button>
                </h3>
                <div class="flex items-center space-x-4 text-sm text-gray-600 mb-2">
                    <span class="inline-flex items-center">
                        <i class="fas fa-folder mr-1"></i>
                        {{ categories.get(prompt.category_id, 'Unknown') }}
                    </span>
                    {% set platforms = prompt.get_platforms() %}
                    {% if platforms %}
                    <div class="flex items-center space-x-2">
                        <span class="text-gray-600 text-xs">
                            <i class="fas fa-robot mr-1"></i>
                            AI Platform{{ 's' if platforms|length > 1 else '' }}:
                        </span>
                        <div class="flex flex-wrap gap-1">
                        {% for platform in platforms %}
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                                {% if platform == 'ChatGPT' %}bg-green-100 text-green-800
                                {% elif platform == 'Claude' %}bg-orange-100 text-orange-800
                                {% elif platform == 'Copilot' or platform == 'Copilot (Researcher)' %}bg-blue-100 text-blue-800
                                {% elif platform == 'Perplexity' %}bg-purple-100 text-purple-800
                                {% elif platform == 'Gemini' %}bg-yellow-100 text-yellow-800
                                {% elif platform == 'Other' %}bg-red-100 text-red-800
                                {% else %}bg-gray-100 text-gray-800{% endif %}">
                                {{ platform }}
                            </span>
                        {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="flex space-x-2">
                <button onclick="togglePromptDetails('{{ prompt.id }}')" 
                        class="bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700">
                    <span id="toggle-text-{{ prompt.id }}">View Details</span>
                </button>
                <button onclick="copyPrompt('{{ prompt.id }}')" 
                        class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                    Copy
                </button>
            </div>
        </div>
        
        <!-- Preview text -->
        <div id="preview-{{ prompt.id }}" class="text-gray-700 text-sm leading-relaxed mb-3">
            {% if prompt.body|length > 200 %}
                {{ prompt.body[:200] }}...
            {% else %}
                {{ prompt.body }}
            {% endif %}
        </div>
        
        <!-- Full details (hidden by default) -->
        <div id="details-{{ prompt.id }}" class="hidden">
            {% if prompt.instructions %}
            <div class="mb-4 p-3 bg-yellow-50 border-l-4 border-yellow-400">
                <h4 class="text-sm font-semibold text-yellow-800 mb-2">
                    <i class="fas fa-lightbulb mr-1"></i>
                    Instructions
                </h4>
                <p class="text-sm text-yellow-700 whitespace-pre-line">{{ prompt.instructions }}</p>
            </div>
            {% endif %}
            
            <div class="p-3 bg-gray-50 border rounded">
                <h4 class="text-sm font-semibold text-gray-800 mb-2">
                    <i class="fas fa-file-text mr-1"></i>
                    Full Prompt
                </h4>
                <p class="text-sm text-gray-700 whitespace-pre-line">{{ prompt.body }}</p>
            </div>
            
            {% set documents = prompt_documents.get(prompt.id, []) %}
            {% if documents %}
            <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded">
                <h4 class="text-sm font-semibold text-blue-800 mb-3">
                    <i class="fas fa-paperclip mr-1"></i>
                    Document Downloads
                </h4>
                <div class="space-y-2">
                    {% for doc in documents %}
                    <div class="flex items-center justify-between p-2 bg-white rounded border">
                        <div class="flex items-center space-x-2">
                            {% if doc.document_type == 'file' %}
                                <i class="fas fa-file text-blue-600"></i>
                                <span class="text-sm font-medium text-gray-900">{{ doc.title }}</span>
                                {% if doc.mime_type %}
                                    <span class="text-xs text-gray-500">({{ doc.mime_type.split('/')[-1].upper() }})</span>
                                {% endif %}
                            {% else %}
                                <i class="fas fa-external-link-alt text-green-600"></i>
                                <span class="text-sm font-medium text-gray-900">{{ doc.title }}</span>
                                <span class="text-xs text-gray-500">(External Link)</span>
                            {% endif %}
                        </div>
                        {% if doc.document_type == 'file' %}
                            <a href="/documents/{{ doc.file_path }}" 
                               target="_blank"
                               class="bg-blue-600 text-white px-3 py-1 text-xs rounded hover:bg-blue-700">
                                <i class="fas fa-download mr-1"></i>Download
                            </a>
                        {% else %}
                            <a href="{{ doc.external_url }}" 
                               target="_blank"
                               class="bg-green-600 text-white px-3 py-1 text-xs rounded hover:bg-green-700">
                                <i class="fas fa-external-link-alt mr-1"></i>Open Link
                            </a>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>

{% if total > page_size %}
<div class="flex justify-center mt-6 space-x-2">
    {% set total_pages = (total + page_size - 1) // page_size %}
    {% for p in range(1, [total_pages + 1, 6]|min) %}
    <button onclick="loadPage({{ p }})" class="{% if p == page %}bg-blue-600 text-white{% else %}bg-white text-gray-700 hover:bg-gray-50{% endif %} px-3 py-2 rounded-md border text-sm">
        {{ p }}
    </button>
    {% endfor %}
</div>
{% endif %}